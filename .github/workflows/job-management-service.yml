name: job-management-service

on:
    push:
        branches:
            - main
        paths:
            - server-side/src/JobManagement/**
            - .github/workflows/job-management-service.yml

jobs:
    build-test:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3

            - name: Build
              run: |
                cd server-side
                dotnet restore "FreelancePlatform.sln"
                cd src/JobManagement/
                for project in $(find . -name "*.csproj"); do
                    echo "Building $project"
                    dotnet build --no-restore "$project"
                done

            - name: Test
              run: |
                cd server-side
                dotnet restore "FreelancePlatform.sln"
                cd src/JobManagement/JobManagement.IntegrationTests
                dotnet build --no-restore
                dotnet test --no-build -v=normal